<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="lentastyles.css">
    <title>Лента</title>
</head>
<body>
    <div class="container" id="container">
        <div class="feed" id="feed"></div>
        <div class="loading-spinner" id="loading-spinner"></div>
    </div>
    <script>
        const feed = document.getElementById('feed');
        const itemsPerPage = 20;
        let currentPage = 1;
        let loading = false;
        let data = []; // Здесь будут храниться данные из JSON-файла

        // Загрузка данных из JSON-файла
        fetch('ID.json')
            .then(response => response.json())
            .then(jsonData => {
                data = jsonData; // Сохраняем данные из JSON-файла

                loadMoreItems(); // Загружаем первую порцию данных
            });

        function createFeedItem(item) {
            const feedItem = document.createElement('div');
            feedItem.classList.add('feed');
            feedItem.innerHTML = `
                <strong>User ID: ${item.userId}</strong><br>
                <strong>ID: ${item.id}</strong><br>
                <strong>Title: ${item.title}</strong><br>
                ${item.body}
            `;
            return feedItem;
        }

        function showLoadingSpinner() {
    loadingSpinner.style.display = 'block';
}

function hideLoadingSpinner() {
    loadingSpinner.style.display = 'none';
}

function loadMoreItems() {
    if (loading) return;

    loading = true;
    showLoadingSpinner(); // Показываем анимацию загрузки

    const startIndex = (currentPage - 1) * itemsPerPage;
    const endIndex = Math.min(startIndex + itemsPerPage, data.length);

    setTimeout(() => {
        for (let i = startIndex; i < endIndex; i++) {
            const feedItem = createFeedItem(data[i]);
            feed.appendChild(feedItem);
        }

        currentPage++;
        loading = false;
        hideLoadingSpinner(); // Скрываем анимацию загрузки
        observeLastItem();
    }, 1000);
}

        function observeLastItem() {
            const lastItem = feed.lastElementChild;
            observer.observe(lastItem);
        }

        let options = {
            root: null,
            rootMargin: "0px",
            threshold: 1.0,
        };
    
        let observer = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    observer.unobserve(entry.target);
                    loadMoreItems();
                }
            });
        }, options);
    </script>
</body>
</html>
