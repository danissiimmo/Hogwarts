<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="lentastyles.css">
    <title>Лента</title>
    <style>
        .loader {
            display: none;
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
        }
        .loader i {
            animation: spin 2s linear infinite;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 20px;
            height: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container" id="container">
        <div class="feed" id="feed"></div>
        <div class="loader" id="loader">
            <i></i>
        </div>
    </div>
    <script>
        const feed = document.getElementById('feed');
        const loader = document.getElementById('loader');
        const itemsPerPage = 20;
        let currentPage = 1;
        let loading = false;
        let data = []; // Здесь будут храниться данные из JSON-файла

        // Загрузка данных из JSON-файла
        fetch('ID.json')
            .then(response => response.json())
            .then(jsonData => {
                data = jsonData; // Сохраняем данные из JSON-файла

                loadMoreItems(); // Загружаем первую порцию данных
            });

        function createFeedItem(item) {
            const feedItem = document.createElement('div');
            feedItem.classList.add('feed');
            feedItem.innerHTML = `
                <strong>User ID: ${item.userId}</strong><br>
                <strong>ID: ${item.id}</strong><br>
                <strong>Title: ${item.title}</strong><br>
                ${item.body}
            `;
            return feedItem;
        }

        function loadMoreItems() {
            if (loading) return;

            loading = true;

            loader.style.display = 'block'; // Показать анимацию загрузки

            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, data.length);

            setTimeout(() => {
                for (let i = startIndex; i < endIndex; i++) {
                    const feedItem = createFeedItem(data[i]);
                    feed.appendChild(feedItem);
                }

                currentPage++;
                loading = false;
                loader.style.display = 'none'; // Скрыть анимацию загрузки
                observeLastItem();
            }, 1000);
        }

        function observeLastItem() {
            const lastItem = feed.lastElementChild;
            observer.observe(lastItem);
        }

        let options = {
            root: null,
            rootMargin: "0px",
            threshold: 1.0,
        };

        let observer = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    observer.unobserve(entry.target);
                    loadMoreItems();
                }
            });
        }, options);
    </script>
</body>
</html>
